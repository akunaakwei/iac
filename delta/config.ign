{"ignition":{"version":"3.4.0"},"passwd":{"users":[{"groups":["sudo"],"name":"akuna","sshAuthorizedKeys":["ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAICjQg4xxpoNQeUuiapCXuahcnDmLvLq1H0B2CJTzdzKW"]}]},"storage":{"files":[{"overwrite":true,"path":"/etc/systemd/network/00-enp1s0.network","contents":{"compression":"","source":"data:,%5BMatch%5D%0AName%3Denp1s0%0A%5BNetwork%5D%0AAddress%3D192.168.0.6%2F24%0AGateway%3D192.168.0.1%0ADNS%3D8.8.8.8%0A"}},{"overwrite":true,"path":"/etc/hostname","contents":{"compression":"","source":"data:,delta"},"mode":420},{"overwrite":true,"path":"/etc/vconsole.conf","contents":{"compression":"","source":"data:,KEYMAP%3Dde"},"mode":420},{"path":"/etc/systemd/resolved.conf","append":[{"compression":"","source":"data:,DNSStubListener%3Dno"}]},{"overwrite":true,"path":"/opt/extensions/docker_compose/docker_compose-2.24.5-x86-64.raw","contents":{"source":"https://github.com/flatcar/sysext-bakery/releases/download/latest/docker_compose-2.24.5-x86-64.raw"},"mode":420},{"overwrite":true,"path":"/etc/sysupdate.docker_compose.d/docker_compose.conf","contents":{"source":"https://github.com/flatcar/sysext-bakery/releases/download/latest/docker_compose.conf"}},{"overwrite":true,"path":"/etc/sysupdate.d/noop.conf","contents":{"source":"https://github.com/flatcar/sysext-bakery/releases/download/latest/noop.conf"}},{"overwrite":true,"path":"/opt/pihole/docker-compose.yml","contents":{"compression":"gzip","source":"data:;base64,H4sIAAAAAAAC/2yS0YqjMBiF7xf2HfICq+1SSpu9cmugQquisRdzE4L5acPExImpZd5+aI0dHaogcr4v8ZikA9vLGjr8+xdCrbwYBY9XhGqjHZcaLNO8AezhwGTDz88o9MMUd9C5QQDdS2t0A9r56RCibxiRqzUthP/BKqmfgBxzUkS0KkiVJhSjeiQl2B5skmO03P4NlutNsAjWI8yTfXYgLE5LhtEmeNz/7s9VsBqdOC1LssPI2Ss8s/0uZ9GOJifyApQ0Kuj0e8vFjJM0ntHtHBdZRUkxM372zY5RkmIktQOruRrxKSloFR3YPivpuLTBXOqNujZ+r+7XH68xwR3HIbja70X4bQjdNbz7mCg+CYS3at4yLsRk1pRQFsXHJB0iC53j1mHE1Y1/dkPYWtlLBWcQ00XU4G7GvrPGCMDoYu7nYdp62ncYIazswWKkTD385qzwC+crAAD//5Cgj2uyAgAA"}}],"links":[{"overwrite":true,"path":"/etc/localtime","target":"../usr/share/zoneinfo/Europe/Berlin"},{"overwrite":true,"path":"/etc/systemd/system/multi-user.target.wants/docker.service","hard":false,"target":"/usr/lib/systemd/system/docker.service"},{"overwrite":true,"path":"/etc/extensions/docker_compose.raw","hard":false,"target":"/opt/extensions/docker_compose/docker_compose-2.24.5-x86-64.raw"}]},"systemd":{"units":[{"enabled":true,"name":"docker.service"},{"contents":"[Unit]\nBefore=docker.service var-lib-docker.mount\nRequiresMountsFor=/var/lib\nConditionPathExists=!/var/lib/docker.btrfs\n[Service]\nType=oneshot\nExecStart=/usr/bin/truncate --size=16G /var/lib/docker.btrfs\nExecStart=/usr/sbin/mkfs.btrfs /var/lib/docker.btrfs\n","name":"format-var-lib-docker.service"},{"contents":"[Unit]\nBefore=docker.service\nAfter=format-var-lib-docker.service\nRequires=format-var-lib-docker.service\n[Mount]\nWhat=/var/lib/docker.btrfs\nWhere=/var/lib/docker\nType=btrfs\nOptions=loop,discard\n[Install]\nRequiredBy=docker.service\n","enabled":true,"name":"var-lib-docker.mount"},{"enabled":true,"name":"systemd-sysupdate.timer"},{"dropins":[{"contents":"[Service]\nExecStartPre=/usr/bin/sh -c \"readlink --canonicalize /etc/extensions/docker_compose.raw \u003e /tmp/docker_compose\"\nExecStartPre=/usr/lib/systemd/systemd-sysupdate -C docker_compose update\nExecStartPost=/usr/bin/sh -c \"readlink --canonicalize /etc/extensions/docker_compose.raw \u003e /tmp/docker_compose-new\"\nExecStartPost=/usr/bin/sh -c \"if ! cmp --silent /tmp/docker_compose /tmp/docker_compose-new; then touch /run/reboot-required; fi\"\n","name":"docker_compose.conf"}],"name":"systemd-sysupdate.service"},{"contents":"[Unit]\nDescription=Start pihole\nAfter=docker.service\nRequires=docker.service\n[Service]\nType=oneshot\nRemainAfterExit=yes\nExecStart=/usr/bin/docker compose -f /opt/pihole/docker-compose.yml up -d\nExecStop=/usr/bin/docker compose -f /opt/pihole/docker-compose.yml stop\n[Install]\nWantedBy=multi-user.target","enabled":true,"name":"start-pihole.service"}]}}
